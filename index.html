<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>MVP ê³„ì‚°ê¸°</title>

<style>
*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui;
  background:#f5f6f8;
}
header{
  background:#2563eb;
  color:white;
  padding:14px 20px;
  display:flex;
  justify-content:space-between;
}
main{max-width:1100px;margin:20px auto;padding:0 16px}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:20px}
.card{
  background:white;
  border-radius:12px;
  padding:18px;
}
input{
  width:100%;
  padding:10px;
  margin-bottom:10px;
}
button{
  border:none;
  padding:8px 12px;
  border-radius:8px;
  cursor:pointer;
}
.primary{background:#2563eb;color:white}
.danger{background:#ef4444;color:white}

table{width:100%;border-collapse:collapse}
th,td{border-bottom:1px solid #ddd;padding:8px;text-align:center}

.mvp-buttons{display:flex;gap:8px;flex-wrap:wrap}
.mvp-buttons button{background:#e5e7eb}
.mvp-buttons button.active{color:white;font-weight:700}

.badge{
  padding:3px 8px;
  border-radius:999px;
  color:white;
  font-size:12px;
}
.bronze{background:#92400e}
.silver{background:#64748b}
.gold{background:#ca8a04}
.diamond{background:#0ea5e9}
.red{background:#ef4444}
.black{background:#111}

.summary-box{
  background:#f1f5f9;
  padding:10px;
  border-radius:8px;
  margin-top:10px;
}

.full{grid-column:1/-1}
</style>
</head>

<body>
<header>
  <strong>MVP ê³„ì‚°ê¸°</strong>
</header>

<main>
<div class="grid">

<div class="card">
<h3>ì¶©ì „ ê¸°ë¡ ì¶”ê°€</h3>
<input type="date" id="date">
<input type="number" id="amount" placeholder="ê¸ˆì•¡">
<button class="primary" onclick="add()">ì¶”ê°€</button>
<button class="danger" onclick="reset()">ì „ì²´ ì´ˆê¸°í™”</button>

<h3>ì¶©ì „ ê¸°ë¡</h3>
<table>
<thead><tr><th>ë‚ ì§œ</th><th>ê¸ˆì•¡</th><th>ì‚­ì œ</th></tr></thead>
<tbody id="list"></tbody>
</table>

<h3>ëª©í‘œ MVP ë“±ê¸‰</h3>
<div class="mvp-buttons" id="targets"></div>
</div>

<div class="card">
<h3>ğŸ“Œ ìš”ì•½ ì •ë³´</h3>
<div id="summary"></div>
</div>

<div class="card full">
<h3>ğŸ“Š ì£¼ì°¨ë³„ ì˜ˆìƒ ë“±ê¸‰ (13ì£¼)</h3>
<table>
<thead><tr><th>ê¸°ì¤€ ì£¼ (ìˆ˜)</th><th>ëˆ„ì </th><th>ë“±ê¸‰</th></tr></thead>
<tbody id="sim"></tbody>
</table>
</div>

</div>
</main>

<script>
const MVP={
  ë¸Œë¡ ì¦ˆ:150000,
  ì‹¤ë²„:300000,
  ê³¨ë“œ:600000,
  ë‹¤ì´ì•„:900000,
  ë ˆë“œ:1500000,
  ë¸”ë™:3000000
};
const cls={
  ë¸Œë¡ ì¦ˆ:'bronze',ì‹¤ë²„:'silver',ê³¨ë“œ:'gold',
  ë‹¤ì´ì•„:'diamond',ë ˆë“œ:'red',ë¸”ë™:'black'
};

let charges=[];
let target='ë ˆë“œ';

function add(){
  const d=date.value,a=+amount.value;
  if(!d||!a)return;
  charges.push({date:new Date(d),amount:a});
  update();
}
function reset(){charges=[];update();}
function del(i){charges.splice(i,1);update();}

function last13WeeksSum(base){
  const start=new Date(base);
  start.setDate(start.getDate()-91);
  return charges.filter(c=>c.date>=start&&c.date<=base)
    .reduce((s,c)=>s+c.amount,0);
}

function grade(sum){
  return Object.entries(MVP).reverse().find(([k,v])=>sum>=v)[0];
}

function badge(g){
  return `<span class="badge ${cls[g]}">${g}</span>`;
}

function wednesday(date){
  const d=new Date(date);
  d.setDate(d.getDate()+(3-d.getDay()+7)%7);
  return d;
}

function update(){
  list.innerHTML=charges.map((c,i)=>`
  <tr>
    <td>${c.date.toISOString().slice(0,10)}</td>
    <td>${c.amount.toLocaleString()}</td>
    <td><button class="danger" onclick="del(${i})">X</button></td>
  </tr>`).join('');

  const today=new Date();
  const thisWed=wednesday(today);
  const sum=last13WeeksSum(thisWed);
  const cur=grade(sum);

  let html=`í˜„ì¬ ë“±ê¸‰: ${badge(cur)}<br>
  ìµœê·¼ 13ì£¼ ì‚¬ìš©ì•¡: ${sum.toLocaleString()}ì›
  <div class="summary-box">
  ğŸ¯ ëª©í‘œ ë“±ê¸‰: ${badge(target)}<br>`;

  if(sum>=MVP[target]){
    html+=`âœ… ëª©í‘œ ë‹¬ì„±<br>ğŸ“… ${thisWed.toISOString().slice(0,10)} ê¹Œì§€ ìœ ì§€`;
  }else{
    html+=`âŒ ${(MVP[target]-sum).toLocaleString()}ì› ì¶”ê°€ í•„ìš”`;
  }
  html+='</div>';
  summary.innerHTML=html;

  sim.innerHTML='';
  for(let i=0;i<13;i++){
    const w=new Date(thisWed);
    w.setDate(w.getDate()+7*i);
    const s=last13WeeksSum(w);
    sim.innerHTML+=`
    <tr>
      <td>${w.toISOString().slice(0,10)}</td>
      <td>${s.toLocaleString()}</td>
      <td>${grade(s)}</td>
    </tr>`;
  }
}

targets.innerHTML=Object.keys(MVP).map(k=>
  `<button class="${cls[k]} ${k===target?'active':''}"
   onclick="target='${k}';update()">${k}</button>`
).join('');

update();
</script>
</body>
</html>
