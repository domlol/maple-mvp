<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ë©”ì´í”ŒìŠ¤í† ë¦¬ MVP ê³„ì‚°ê¸°</title>

<style>
:root {
  --bg:#f4f6f8;
  --card:#ffffff;
  --text:#222;
  --sub:#666;
}

body {
  margin:0;
  font-family: Pretendard, Arial, sans-serif;
  background:var(--bg);
  color:var(--text);
}

header {
  background:#2563eb;
  color:#fff;
  padding:20px;
  font-size:22px;
  font-weight:700;
}

.container {
  max-width:1100px;
  margin:30px auto;
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:24px;
}

.card {
  background:var(--card);
  border-radius:14px;
  padding:20px;
  box-shadow:0 4px 12px rgba(0,0,0,.05);
}

h3 { margin-top:0; }

input {
  width:100%;
  padding:12px;
  margin-top:6px;
  border-radius:8px;
  border:1px solid #ccc;
}

button {
  padding:8px 14px;
  border-radius:8px;
  border:none;
  cursor:pointer;
}

.btn-add { background:#2563eb; color:#fff; }
.btn-reset { background:#ef4444; color:#fff; }

.badge {
  display:inline-block;
  padding:4px 10px;
  border-radius:999px;
  font-weight:700;
  color:#fff;
  margin-left:6px;
  font-size:13px;
}

.mvp-bronze { background:#cd7f32; }
.mvp-silver { background:#9ca3af; }
.mvp-gold { background:#facc15; color:#000; }
.mvp-diamond { background:#22d3ee; color:#000; }
.mvp-red { background:#ef4444; }
.mvp-black { background:#111827; }

table {
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
}

th, td {
  padding:8px;
  border-bottom:1px solid #e5e7eb;
  text-align:center;
}

.mvp-buttons button {
  margin:6px 6px 0 0;
}

.summary-box {
  margin-top:14px;
  padding:14px;
  background:#f9fafb;
  border-radius:10px;
}
</style>
</head>

<body>
<header>ë©”ì´í”ŒìŠ¤í† ë¦¬ MVP ê³„ì‚°ê¸°</header>

<div class="container">
  <!-- ì™¼ìª½ -->
  <div class="card">
    <h3>ì¶©ì „ ê¸°ë¡ ì¶”ê°€</h3>

    <label>ìºì‹œ ì‚¬ìš© ë‚ ì§œ</label>
    <input type="date" id="dateInput">

    <label>ê¸ˆì•¡</label>
    <input type="number" id="amountInput">

    <div style="margin-top:10px">
      <button class="btn-add" onclick="addCharge()">ì¶”ê°€</button>
      <button class="btn-reset" onclick="resetAll()">ì „ì²´ ì´ˆê¸°í™”</button>
    </div>

    <p style="color:#f97316; font-size:13px; margin-top:10px">
      âš  MVP ê³„ì‚°ì€ ìºì‹œ ì¶©ì „ì¼ì´ ì•„ë‹Œ ì‹¤ì œ ì‚¬ìš© ë‚ ì§œ ê¸°ì¤€ì…ë‹ˆë‹¤.
    </p>

    <h3>ì¶©ì „ ê¸°ë¡</h3>
    <table>
      <thead>
        <tr><th>ë‚ ì§œ</th><th>ê¸ˆì•¡</th><th>ì†Œë©¸</th></tr>
      </thead>
      <tbody id="chargeList"></tbody>
    </table>

    <h3>ëª©í‘œ MVP ë“±ê¸‰</h3>
    <div class="mvp-buttons">
      <button onclick="setTarget('ë¸Œë¡ ì¦ˆ')">ë¸Œë¡ ì¦ˆ</button>
      <button onclick="setTarget('ì‹¤ë²„')">ì‹¤ë²„</button>
      <button onclick="setTarget('ê³¨ë“œ')">ê³¨ë“œ</button>
      <button onclick="setTarget('ë‹¤ì´ì•„')">ë‹¤ì´ì•„</button>
      <button onclick="setTarget('ë ˆë“œ')">ë ˆë“œ</button>
      <button onclick="setTarget('ë¸”ë™')">ë¸”ë™</button>
    </div>
  </div>

  <!-- ì˜¤ë¥¸ìª½ -->
  <div class="card">
    <h3>ğŸ“Œ ìš”ì•½ ì •ë³´</h3>
    <div id="summary"></div>
  </div>
</div>

<div class="card" style="max-width:1100px;margin:0 auto 40px">
  <h3>ğŸ“Š ì£¼ì°¨ë³„ ì˜ˆìƒ ë“±ê¸‰ ì‹œë®¬ë ˆì´ì…˜</h3>
  <table>
    <thead>
      <tr><th>ê¸°ì¤€ ë‚ ì§œ</th><th>ì˜ˆìƒ ëˆ„ì </th><th>ë“±ê¸‰</th></tr>
    </thead>
    <tbody id="weekly"></tbody>
  </table>
</div>

<script>
const MVP = {
  ë¸Œë¡ ì¦ˆ:150000, ì‹¤ë²„:300000, ê³¨ë“œ:600000,
  ë‹¤ì´ì•„:900000, ë ˆë“œ:1500000, ë¸”ë™:3000000
};

let charges = [];
let target = null;

function getBadge(grade){
  const cls = {
    ë¸Œë¡ ì¦ˆ:'bronze', ì‹¤ë²„:'silver', ê³¨ë“œ:'gold',
    ë‹¤ì´ì•„:'diamond', ë ˆë“œ:'red', ë¸”ë™:'black'
  }[grade];
  return `<span class="badge mvp-${cls}">${grade}</span>`;
}

function addCharge(){
  const d = dateInput.value;
  const a = +amountInput.value;
  if(!d || !a) return;

  charges.push({
    date:new Date(d),
    amount:a,
    expire:new Date(new Date(d).getTime()+90*86400000)
  });

  dateInput.value='';
  amountInput.value='';
  updateAll();   // ğŸ”´ í•µì‹¬ ìˆ˜ì •
}

function resetAll(){
  charges=[];
  target=null;
  updateAll();
}

function setTarget(t){
  target=t;
  updateAll();
}

function calcSum(base){
  return charges
    .filter(c=>c.date<=base && c.expire>=base)
    .reduce((s,c)=>s+c.amount,0);
}

function getGrade(sum){
  return Object.keys(MVP).reverse().find(g=>sum>=MVP[g]) || 'ì—†ìŒ';
}

function updateAll(){
  renderList();
  renderSummary();
  renderWeekly();
}

function renderList(){
  chargeList.innerHTML='';
  charges.sort((a,b)=>b.date-a.date).forEach(c=>{
    chargeList.innerHTML+=`
      <tr>
        <td>${c.date.toISOString().slice(0,10)}</td>
        <td>${c.amount.toLocaleString()}</td>
        <td>${c.expire.toISOString().slice(0,10)}</td>
      </tr>`;
  });
}

function renderSummary(){
  const now=new Date();
  const sum=calcSum(now);
  const grade=getGrade(sum);

  let html=`í˜„ì¬ ë“±ê¸‰: ${grade!=='ì—†ìŒ'?getBadge(grade):'ì—†ìŒ'}<br>
            ìµœê·¼ 13ì£¼ ëˆ„ì : ${sum.toLocaleString()}ì›`;

  if(target){
    if(sum>=MVP[target]){
      const minExpire = Math.min(...charges.map(c=>c.expire));
      html+=`
        <div class="summary-box">
          ğŸ¯ ëª©í‘œ ë“±ê¸‰: ${getBadge(target)}<br>
          âœ… ëª©í‘œ ë‹¬ì„±<br>
          ğŸ“… ${minExpire.toISOString().slice(0,10)} ê¹Œì§€ ìœ ì§€ ê°€ëŠ¥
        </div>`;
    } else {
      html+=`
        <div class="summary-box">
          ğŸ¯ ëª©í‘œ ë“±ê¸‰: ${getBadge(target)}<br>
          âŒ ${(MVP[target]-sum).toLocaleString()}ì› ì¶”ê°€ í•„ìš”
        </div>`;
    }
  }
  summary.innerHTML=html;
}

function renderWeekly(){
  weekly.innerHTML='';
  for(let i=0;i<13;i++){
    const d=new Date();
    d.setDate(d.getDate()+i*7);
    const sum=calcSum(d);
    weekly.innerHTML+=`
      <tr>
        <td>${d.toISOString().slice(0,10)}</td>
        <td>${sum.toLocaleString()}</td>
        <td>${getGrade(sum)}</td>
      </tr>`;
  }
}

updateAll();
</script>
</body>
</html>
