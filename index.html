<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>ë©”ì´í”ŒìŠ¤í† ë¦¬ MVP ê³„ì‚°ê¸°</title>

<style>
:root{
  --bg:#f4f6f8; --card:#fff; --text:#222;
}
.dark{
  --bg:#121212; --card:#1e1e1e; --text:#eee;
}
body{
  margin:0;font-family:Pretendard,system-ui;
  background:var(--bg);color:var(--text);
}
header{
  background:#2563eb;color:#fff;
  padding:14px 20px;
  display:flex;justify-content:space-between;
}
.container{max-width:1200px;margin:20px auto;padding:0 16px;}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:20px;}
.card{
  background:var(--card);border-radius:12px;
  padding:20px;
}
h3{margin:0 0 14px;}
input{
  padding:10px;font-size:16px;
}
button{cursor:pointer;border:none;border-radius:6px;padding:8px 14px;}
.btn-add{background:#2563eb;color:#fff;}
.btn-reset{background:#ef4444;color:#fff;margin-left:6px;}

.notice{
  background:#fff3cd;color:#856404;
  padding:10px;border-left:5px solid #f59e0b;
  margin:12px 0;
}
table{width:100%;border-collapse:collapse;}
th,td{padding:10px;border-bottom:1px solid #ddd;text-align:center;}

.badges button{
  flex:1;padding:10px;font-weight:700;
  border-radius:8px;color:#fff;
}
.badges{display:flex;gap:8px;margin-top:12px;}

.bronze{background:#cd7f32;}
.silver{background:#9ca3af;}
.gold{background:#facc15;color:#000;}
.dia{background:#38bdf8;}
.red{background:#ef4444;}
.black{background:#000;}

.summary span.badge{
  display:inline-block;padding:4px 10px;
  border-radius:999px;color:#fff;font-weight:700;
}

.toggle{background:#fff;color:#000;padding:6px 10px;border-radius:6px;}
.dark .toggle{background:#000;color:#fff;}
</style>
</head>

<body>
<header>
  <div>ë©”ì´í”ŒìŠ¤í† ë¦¬ MVP ê³„ì‚°ê¸°</div>
  <button class="toggle" onclick="toggleTheme()">ğŸŒ™ / â˜€ï¸</button>
</header>

<div class="container">
<div class="grid">

<!-- ì…ë ¥ -->
<div class="card">
<h3>ì¶©ì „ ê¸°ë¡ ì¶”ê°€</h3>
<input type="date" id="date">
<input type="number" id="amount" placeholder="ê¸ˆì•¡" style="margin-left:8px;width:160px">
<br><br>
<button class="btn-add" onclick="add()">ì¶”ê°€</button>
<button class="btn-reset" onclick="resetAll()">ì „ì²´ ì´ˆê¸°í™”</button>

<div class="notice">âš  MVP ê³„ì‚°ì€ ì‹¤ì œ ìºì‹œ ì‚¬ìš© ë‚ ì§œ ê¸°ì¤€ì…ë‹ˆë‹¤.</div>

<h3>ì¶©ì „ ê¸°ë¡</h3>
<table>
<thead><tr><th>ë‚ ì§œ</th><th>ê¸ˆì•¡</th><th>ì‚­ì œ</th></tr></thead>
<tbody id="rows"></tbody>
</table>

<h3 style="margin-top:20px;">ëª©í‘œ MVP ë“±ê¸‰</h3>
<div class="badges">
<button class="bronze" onclick="setTarget('ë¸Œë¡ ì¦ˆ')">ë¸Œë¡ ì¦ˆ</button>
<button class="silver" onclick="setTarget('ì‹¤ë²„')">ì‹¤ë²„</button>
<button class="gold" onclick="setTarget('ê³¨ë“œ')">ê³¨ë“œ</button>
<button class="dia" onclick="setTarget('ë‹¤ì´ì•„')">ë‹¤ì´ì•„</button>
<button class="red" onclick="setTarget('ë ˆë“œ')">ë ˆë“œ</button>
<button class="black" onclick="setTarget('ë¸”ë™')">ë¸”ë™</button>
</div>
</div>

<!-- ìš”ì•½ -->
<div class="card summary">
<h3>ğŸ“Œ ìš”ì•½ ì •ë³´</h3>
<div id="summary"></div>
</div>

</div>

<!-- ì‹œë®¬ -->
<div class="card" style="margin-top:20px;">
<h3>ğŸ“Š ì£¼ì°¨ë³„ ì˜ˆìƒ ë“±ê¸‰ ì‹œë®¬ë ˆì´ì…˜ (13ì£¼)</h3>
<table>
<thead><tr><th>ê¸°ì¤€ ë‚ ì§œ(ëª©)</th><th>ëˆ„ì </th><th>ë“±ê¸‰</th></tr></thead>
<tbody id="sim"></tbody>
</table>
</div>

</div>

<script>
const RANKS={
  "ë¸Œë¡ ì¦ˆ":0,
  "ì‹¤ë²„":500000,
  "ê³¨ë“œ":1000000,
  "ë‹¤ì´ì•„":1200000,
  "ë ˆë“œ":1500000,
  "ë¸”ë™":3000000
};

let data=[],target="ë ˆë“œ";

function toggleTheme(){document.body.classList.toggle("dark");}

function add(){
  const d=document.getElementById("date").value;
  const a=+document.getElementById("amount").value;
  if(!d||!a)return;
  data.push({d:new Date(d),a});
  render();
}

function resetAll(){data=[];render();}

function setTarget(t){target=t;render();}

function sumAt(base){
  const from=new Date(base);from.setDate(from.getDate()-91);
  return data.filter(x=>x.d>from&&x.d<=base)
             .reduce((s,x)=>s+x.a,0);
}

function getRank(sum){
  return Object.entries(RANKS).reverse()
    .find(r=>sum>=r[1])?.[0]||"ì—†ìŒ";
}

function render(){
  const rows=document.getElementById("rows");
  rows.innerHTML="";
  data.sort((a,b)=>b.d-a.d).forEach((x,i)=>{
    rows.innerHTML+=`<tr>
      <td>${x.d.toISOString().slice(0,10)}</td>
      <td>${x.a.toLocaleString()}</td>
      <td><button onclick="data.splice(${i},1);render()">X</button></td>
    </tr>`;
  });

  const today=new Date();
  const curSum=sumAt(today);
  const curRank=getRank(curSum);

  // ìœ ì§€ ì¢…ë£Œ ê³„ì‚°
  let endDate=null;
  for(let i=0;i<180;i++){
    const d=new Date(today);d.setDate(d.getDate()+i);
    if(sumAt(d)<RANKS[curRank]){
      endDate=new Date(d);endDate.setDate(endDate.getDate()-1);
      break;
    }
  }

  // ë‹¤ìŒ ì£¼ ìœ ì§€ í•„ìš” ê¸ˆì•¡
  const next=new Date(today);
  next.setDate(next.getDate()+7);
  const nextSum=sumAt(next);
  const need=Math.max(0,RANKS[target]-nextSum);

  document.getElementById("summary").innerHTML=`
  í˜„ì¬ ë“±ê¸‰: <span class="badge ${curRank==='ë ˆë“œ'?'red':curRank==='ë‹¤ì´ì•„'?'dia':''}">${curRank}</span><br><br>
  ìµœê·¼ 13ì£¼ ëˆ„ì : ${curSum.toLocaleString()}ì›<br><br>
  ëª©í‘œ ë“±ê¸‰: <span class="badge">${target}</span><br><br>
  ${curSum>=RANKS[target]?"âœ… ëª©í‘œ ë‹¬ì„±":"âŒ ëª©í‘œ ë¯¸ë‹¬"}<br>
  ${endDate?endDate.toISOString().slice(0,10)+"ê¹Œì§€ ìœ ì§€":""}<br>
  ì´í›„ ìœ ì§€ë¥¼ ìœ„í•´ ${need.toLocaleString()}ì› í•„ìš”
  `;

  const sim=document.getElementById("sim");
  sim.innerHTML="";
  const base=new Date();
  base.setDate(base.getDate()-((base.getDay()+3)%7));
  for(let i=0;i<13;i++){
    const d=new Date(base);d.setDate(d.getDate()+i*7);
    const s=sumAt(d);
    sim.innerHTML+=`<tr>
      <td>${d.toISOString().slice(0,10)}</td>
      <td>${s.toLocaleString()}</td>
      <td>${getRank(s)}</td>
    </tr>`;
  }
}
render();
</script>
</body>
</html>
