<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ë©”ì´í”ŒìŠ¤í† ë¦¬ MVP ê³„ì‚°ê¸°</title>

<style>
:root{
  --bg:#f5f6f7; --card:#fff; --text:#222;
}
body.dark{
  --bg:#121212; --card:#1e1e1e; --text:#f1f1f1;
}
body{
  margin:0;font-family:system-ui;
  background:var(--bg);color:var(--text);
}
header{
  background:#2563eb;color:#fff;
  padding:14px 20px;
  display:flex;justify-content:space-between;
}
.container{max-width:1100px;margin:20px auto;padding:0 12px;}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:20px;}
.card{background:var(--card);border-radius:12px;padding:18px;}

.badge{padding:4px 12px;border-radius:999px;color:#fff;font-weight:600}
.badge-ë¸Œë¡ ì¦ˆ{background:#cd7f32}
.badge-ì‹¤ë²„{background:#9ca3af}
.badge-ê³¨ë“œ{background:#facc15;color:#000}
.badge-ë‹¤ì´ì•„{background:#38bdf8}
.badge-ë ˆë“œ{background:#ef4444}
.badge-ë¸”ë™{background:#000}

.target-wrap{
  display:grid;
  grid-template-columns:repeat(6,1fr);
  gap:6px;
}
.target-btn{
  border:none;border-radius:10px;
  padding:8px 0;font-weight:600;color:#fff;
  cursor:pointer;
}

input{
  width:100%;
  height:44px;
  font-size:16px;
  padding:0 10px;
  margin:6px 0;
}

.notice{
  background:#fef3c7;
  color:#92400e;
  padding:10px 12px;
  border-radius:8px;
  font-size:14px;
  margin-bottom:10px;
}

table{width:100%;border-collapse:collapse;margin-top:10px}
th,td{padding:8px;border-bottom:1px solid #ccc;text-align:center}
</style>
</head>

<body>
<header>
  ë©”ì´í”ŒìŠ¤í† ë¦¬ MVP ê³„ì‚°ê¸°
  <button onclick="document.body.classList.toggle('dark')">ğŸŒ™/â˜€ï¸</button>
</header>

<div class="container">
<div class="grid">

<div class="card">
<h3>ì¶©ì „ ê¸°ë¡ ì¶”ê°€</h3>

<div class="notice">
âš ï¸ <b>ì£¼ì˜ì‚¬í•­</b><br>
ìºì‹œ <b>ì¶©ì „ ê¸ˆì•¡</b>ì´ ì•„ë‹Œ, <b>ìºì‹œ ì‚¬ìš© ë‚ ì§œ ê¸°ì¤€</b>ìœ¼ë¡œ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤.
</div>

<input type="date" id="dateInput">
<input type="number" id="amountInput" placeholder="ì‚¬ìš©í•œ ìºì‹œ ê¸ˆì•¡">
<button onclick="addRecord()">ì¶”ê°€</button>

<h4>ì¶©ì „ ê¸°ë¡</h4>
<table>
<thead><tr><th>ë‚ ì§œ</th><th>ê¸ˆì•¡</th><th></th></tr></thead>
<tbody id="recordTable"></tbody>
</table>

<h4>ëª©í‘œ MVP ë“±ê¸‰</h4>
<div class="target-wrap" id="targetButtons"></div>
</div>

<div class="card">
<h3>ğŸ“Œ ìš”ì•½ ì •ë³´</h3>
<p>í˜„ì¬ ë“±ê¸‰: <span id="currentBadge"></span></p>
<p>13ì£¼ ëˆ„ì : <b id="totalText"></b></p>
<p>ëª©í‘œ ë“±ê¸‰: <span id="targetBadge"></span></p>
<p id="goalText"></p>
</div>

</div>

<div class="card">
<h3>ğŸ“Š ì£¼ì°¨ë³„ ì˜ˆìƒ ë“±ê¸‰ (13ì£¼)</h3>
<table>
<thead><tr><th>ê¸°ì¤€ ëª©ìš”ì¼</th><th>ëˆ„ì </th><th>ë“±ê¸‰</th></tr></thead>
<tbody id="weekTable"></tbody>
</table>
</div>
</div>

<script>
const MVP=[
 {name:"ë¸Œë¡ ì¦ˆ",min:150000},
 {name:"ì‹¤ë²„",min:300000},
 {name:"ê³¨ë“œ",min:600000},
 {name:"ë‹¤ì´ì•„",min:900000},
 {name:"ë ˆë“œ",min:1500000},
 {name:"ë¸”ë™",min:3000000}
];

let records=[];
let target="ë ˆë“œ";

function lastThursday(base=new Date()){
  const d=new Date(base);
  const diff=(d.getDay()>=4)?d.getDay()-4:d.getDay()+3;
  d.setDate(d.getDate()-diff);
  d.setHours(0,0,0,0);
  return d;
}
function fmt(d){
  return `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,"0")}-${String(d.getDate()).padStart(2,"0")}`;
}
function grade(sum){
  return MVP.filter(m=>sum>=m.min).pop()||MVP[0];
}
function sum13(base){
  const s=new Date(base);s.setDate(s.getDate()-84);
  return records.filter(r=>{
    const d=new Date(r.date);
    return d>=s&&d<=base;
  }).reduce((a,b)=>a+b.amount,0);
}

function addRecord(){
  if(!dateInput.value||!amountInput.value)return;
  records.push({date:dateInput.value,amount:+amountInput.value});
  update();
}

function update(){
recordTable.innerHTML="";
records.forEach((r,i)=>{
recordTable.innerHTML+=`
<tr><td>${r.date}</td>
<td>${r.amount.toLocaleString()}</td>
<td><button onclick="records.splice(${i},1);update()">X</button></td></tr>`;
});

targetButtons.innerHTML="";
MVP.forEach(m=>{
targetButtons.innerHTML+=
`<button class="target-btn badge-${m.name}" onclick="target='${m.name}';update()">${m.name}</button>`;
});

const base=lastThursday();
const total=sum13(base);
const cur=grade(total);
const tar=MVP.find(m=>m.name===target);

currentBadge.innerHTML=`<span class="badge badge-${cur.name}">${cur.name}</span>`;
targetBadge.innerHTML=`<span class="badge badge-${tar.name}">${tar.name}</span>`;
totalText.innerText=total.toLocaleString()+"ì›";

weekTable.innerHTML="";
let breakDate=null;
let breakSum=0;
for(let i=0;i<13;i++){
const d=new Date(base);d.setDate(d.getDate()+7*i);
const s=sum13(d);
if(!breakDate&&s<tar.min){breakDate=d;breakSum=s;}
weekTable.innerHTML+=`
<tr><td>${fmt(d)}</td><td>${s.toLocaleString()}</td><td>${grade(s).name}</td></tr>`;
}

if(total<tar.min){
goalText.innerHTML=`âŒ ëª©í‘œ ë‹¬ì„±ê¹Œì§€ ${(tar.min-total).toLocaleString()}ì› í•„ìš”`;
}else if(tar.min<600000){
goalText.innerHTML=`í˜„ì¬ MVP ìœ ì§€ ì¤‘`;
}else if(breakDate){
goalText.innerHTML=
`${fmt(breakDate)} ì´í›„ ìœ ì§€ë¥¼ ìœ„í•´ ${(tar.min-breakSum).toLocaleString()}ì› í•„ìš”`;
}else{
goalText.innerHTML=`13ì£¼ ë™ì•ˆ ëª©í‘œ ë“±ê¸‰ ìœ ì§€`;
}
}
update();
</script>
</body>
</html>
