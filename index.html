<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>ë©”ì´í”ŒìŠ¤í† ë¦¬ MVP ê³„ì‚°ê¸°</title>

<style>
:root {
  --bg:#f5f6f8; --card:#fff; --text:#111; --sub:#666;
}
.dark {
  --bg:#121212; --card:#1e1e1e; --text:#f1f1f1; --sub:#aaa;
}
body {
  margin:0; font-family:system-ui;
  background:var(--bg); color:var(--text);
}
header {
  background:#2563eb; color:#fff;
  padding:16px 24px;
  display:flex; justify-content:space-between; align-items:center;
}
.container {
  max-width:1100px; margin:24px auto; padding:0 16px;
}
.grid {
  display:grid; grid-template-columns:1fr 1fr; gap:24px;
}
.card {
  background:var(--card); border-radius:12px;
  padding:20px;
}
h2 { margin:0 0 12px; }
input, button {
  padding:8px 10px; border-radius:6px;
  border:1px solid #ccc;
}
button { cursor:pointer; }
.primary { background:#2563eb; color:#fff; border:none; }
.danger { background:#ef4444; color:#fff; border:none; }
.notice {
  margin:12px 0; padding:10px;
  background:#fff7ed; border-left:4px solid #f97316;
  font-size:14px;
}
table {
  width:100%; border-collapse:collapse;
}
th, td {
  padding:8px; border-bottom:1px solid #ddd;
  text-align:center;
}
.badge {
  padding:4px 10px; border-radius:999px;
  color:#fff; font-size:13px;
}
.bronze{background:#a16207}
.silver{background:#9ca3af}
.gold{background:#facc15;color:#000}
.diamond{background:#38bdf8}
.red{background:#ef4444}
.black{background:#000}
.rank-btns button {
  width:100%; margin:4px 0;
}
.rank-grid {
  display:grid; grid-template-columns:repeat(6,1fr); gap:8px;
  margin-top:12px;
}
.selected { outline:3px solid #000; }
.toggle { background:#fff; border-radius:8px; }
.spacer { margin-top:24px; }
</style>
</head>

<body>
<header>
  <h1>ë©”ì´í”ŒìŠ¤í† ë¦¬ MVP ê³„ì‚°ê¸°</h1>
  <button class="toggle" onclick="toggleTheme()">ğŸŒ™ / â˜€ï¸</button>
</header>

<div class="container">
<div class="grid">

<!-- ì¢Œì¸¡ -->
<div class="card">
<h2>ì¶©ì „ ê¸°ë¡ ì¶”ê°€</h2>
<input type="date" id="date">
<input type="number" id="amount" placeholder="ê¸ˆì•¡">
<br><br>
<button class="primary" onclick="add()">ì¶”ê°€</button>
<button class="danger" onclick="resetAll()">ì „ì²´ ì´ˆê¸°í™”</button>

<div class="notice">âš  MVP ê³„ì‚°ì€ ìºì‹œ ì¶©ì „ì¼ì´ ì•„ë‹Œ ì‹¤ì œ ìºì‹œ ì‚¬ìš© ë‚ ì§œ ê¸°ì¤€ì…ë‹ˆë‹¤.</div>

<h3>ì¶©ì „ ê¸°ë¡</h3>
<table>
<thead><tr><th>ë‚ ì§œ</th><th>ê¸ˆì•¡</th><th>ì‚­ì œ</th></tr></thead>
<tbody id="list"></tbody>
</table>

<div class="spacer"></div>

<h3>ëª©í‘œ MVP ë“±ê¸‰</h3>
<div class="rank-grid" id="targets"></div>
</div>

<!-- ìš°ì¸¡ -->
<div class="card">
<h2>ğŸ“Œ ìš”ì•½ ì •ë³´</h2>
<div id="summary"></div>
</div>

</div>

<div class="card spacer">
<h2>ğŸ“Š ì£¼ì°¨ë³„ ì˜ˆìƒ ë“±ê¸‰ ì‹œë®¬ë ˆì´ì…˜ (13ì£¼)</h2>
<table>
<thead><tr><th>ê¸°ì¤€ ë‚ ì§œ (ëª©)</th><th>ëˆ„ì </th><th>ë“±ê¸‰</th></tr></thead>
<tbody id="weeks"></tbody>
</table>
</div>

</div>

<script>
const ranks=[
{n:'ë¸Œë¡ ì¦ˆ',v:0,c:'bronze'},
{n:'ì‹¤ë²„',v:500000,c:'silver'},
{n:'ê³¨ë“œ',v:1000000,c:'gold'},
{n:'ë‹¤ì´ì•„',v:1500000,c:'diamond'},
{n:'ë ˆë“œ',v:1500000,c:'red'},
{n:'ë¸”ë™',v:3000000,c:'black'}
];

let data=JSON.parse(localStorage.getItem('mvp')||'[]');
let target=localStorage.getItem('target')||'ë ˆë“œ';

function toggleTheme(){
document.body.classList.toggle('dark');
localStorage.theme=document.body.classList.contains('dark');
}
if(localStorage.theme==='true')toggleTheme();

function add(){
data.push({d:date.value,a:+amount.value});
save();
}
function resetAll(){data=[];save();}
function del(i){data.splice(i,1);save();}
function save(){
localStorage.mvp=JSON.stringify(data);
render();
}
function sumAt(base){
const from=new Date(base);
from.setDate(from.getDate()-90);
return data.filter(x=>{
const d=new Date(x.d);
return d>=from&&d<=base;
}).reduce((s,x)=>s+x.a,0);
}
function rankOf(v){
for(let i=ranks.length-1;i>=0;i--)
if(v>=ranks[i].v)return ranks[i];
return ranks[0];
}

function render(){
list.innerHTML=data.map((x,i)=>`
<tr>
<td>${x.d}</td>
<td>${x.a.toLocaleString()}</td>
<td><button onclick="del(${i})">X</button></td>
</tr>`).join('');

targets.innerHTML=ranks.map(r=>`
<button class="${r.c} ${r.n===target?'selected':''}"
onclick="target='${r.n}';localStorage.target=target;render()">
${r.n}</button>`).join('');

const today=new Date();
const th=new Date(today);
th.setDate(today.getDate()-((today.getDay()+3)%7));

const nowSum=sumAt(th);
const nowRank=rankOf(nowSum);
const targetRank=ranks.find(r=>r.n===target);

let html=`
í˜„ì¬ ë“±ê¸‰: <span class="badge ${nowRank.c}">${nowRank.n}</span><br>
ìµœê·¼ 13ì£¼ ëˆ„ì : ${nowSum.toLocaleString()}ì›
<div class="spacer"></div>
ëª©í‘œ ë“±ê¸‰: <span class="badge ${targetRank.c}">${target}</span><br>
`;

if(nowSum>=targetRank.v){
const until=new Date(th); until.setDate(until.getDate()+91);
html+=`âœ… ëª©í‘œ ë‹¬ì„±<br>${until.toISOString().slice(0,10)}ê¹Œì§€ ìœ ì§€<br>
ì´í›„ ìœ ì§€ë¥¼ ìœ„í•´ ${targetRank.v.toLocaleString()}ì› í•„ìš”`;
}else{
html+=`âŒ ëª©í‘œ ë¯¸ë‹¬<br>${(targetRank.v-nowSum).toLocaleString()}ì› ì¶”ê°€ í•„ìš”`;
}
summary.innerHTML=html;

weeks.innerHTML='';
for(let i=0;i<13;i++){
const d=new Date(th);
d.setDate(th.getDate()-7*i);
const s=sumAt(d);
const r=rankOf(s);
weeks.innerHTML+=`
<tr>
<td>${d.toISOString().slice(0,10)}</td>
<td>${s.toLocaleString()}</td>
<td>${r.n}</td>
</tr>`;
}
}
render();
</script>
</body>
</html>
