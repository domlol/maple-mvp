<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>MVP ê³„ì‚°ê¸°</title>

<style>
:root {
  --bg: #f4f6f8;
  --card: #fff;
  --text: #222;
}
body.dark {
  --bg: #1e1f22;
  --card: #2b2d31;
  --text: #e6e6e6;
}
body {
  margin: 0;
  background: var(--bg);
  color: var(--text);
  font-family: Pretendard, sans-serif;
}
header {
  background: #2563eb;
  color: #fff;
  padding: 16px;
  display:flex;
  justify-content:space-between;
}
button { cursor:pointer; }
.container {
  max-width: 1100px;
  margin: 20px auto;
}
.grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 20px;
}
.card {
  background: var(--card);
  border-radius: 12px;
  padding: 20px;
}
input {
  width: 100%;
  padding: 10px;
  box-sizing: border-box;
}
.badge {
  padding: 4px 10px;
  border-radius: 999px;
  font-weight: 600;
  color: #fff;
}
.table {
  width: 100%;
  border-collapse: collapse;
}
.table th, .table td {
  padding: 8px;
  border-bottom: 1px solid #ddd;
  text-align: center;
}
.muted {
  opacity: .7;
}
.goal-box {
  margin-top: 12px;
  padding: 12px;
  border-radius: 10px;
  background: rgba(0,0,0,.05);
}
</style>
</head>

<body>
<header>
  <strong>MVP ê³„ì‚°ê¸°</strong>
  <button onclick="toggleTheme()">ë‹¤í¬ / ë¼ì´íŠ¸</button>
</header>

<div class="container">

<div class="grid">
  <div class="card">
    <h3>ì¶©ì „ ê¸°ë¡ ì¶”ê°€</h3>
    <input type="date" id="date" />
    <input type="number" id="amount" placeholder="ê¸ˆì•¡" />
    <br><br>
    <button onclick="add()">ì¶”ê°€</button>
    <button onclick="clearAll()">ì „ì²´ ì´ˆê¸°í™”</button>

    <h4>ì¶©ì „ ê¸°ë¡</h4>
    <table class="table">
      <thead><tr><th>ë‚ ì§œ</th><th>ê¸ˆì•¡</th><th>ì‚­ì œ</th></tr></thead>
      <tbody id="log"></tbody>
    </table>

    <h4>ëª©í‘œ MVP ë“±ê¸‰</h4>
    <div id="targets"></div>
  </div>

  <div class="card">
    <h3>ğŸ“Œ ìš”ì•½ ì •ë³´</h3>
    <div id="summary"></div>
  </div>
</div>

<div class="card">
  <h3>ğŸ“Š ì£¼ì°¨ë³„ ì˜ˆìƒ ë“±ê¸‰ (13ì£¼)</h3>
  <table class="table">
    <thead><tr><th>ê¸°ì¤€ ì£¼(ëª©)</th><th>ëˆ„ì </th><th>ë“±ê¸‰</th></tr></thead>
    <tbody id="weeks"></tbody>
  </table>
</div>

</div>

<script>
const MVP_LEVELS = [
  { name:"ë¸Œë¡ ì¦ˆ", min:150000, color:"#cd7f32" },
  { name:"ì‹¤ë²„", min:300000, color:"#c0c0c0" },
  { name:"ê³¨ë“œ", min:600000, color:"#ffd700" },
  { name:"ë‹¤ì´ì•„", min:900000, color:"#00cfff" },
  { name:"ë ˆë“œ", min:1500000, color:"#ff4d4f" },
  { name:"ë¸”ë™", min:3000000, color:"#111" },
];

let records = [];
let target = null;

function getThursday(d){
  const date = new Date(d);
  const day = date.getDay();
  const diff = (day<=4?4-day:11-day);
  date.setDate(date.getDate()+diff);
  date.setHours(0,0,0,0);
  return date;
}
function getGrade(sum){
  return [...MVP_LEVELS].reverse().find(l=>sum>=l.min);
}

function add(){
  const d = date.value;
  const a = +amount.value;
  if(!d||!a) return;
  records.push({d,a});
  render();
}

function remove(i){
  records.splice(i,1);
  render();
}

function clearAll(){
  records=[];
  render();
}

function render(){
  const log = document.getElementById("log");
  log.innerHTML="";
  records.forEach((r,i)=>{
    log.innerHTML+=`
    <tr>
      <td>${r.d}</td>
      <td>${r.a.toLocaleString()}</td>
      <td><button onclick="remove(${i})">X</button></td>
    </tr>`;
  });

  const ths = records.map(r=>({t:getThursday(r.d),a:r.a}));
  const now = new Date();
  const base = getThursday(now);
  let sum=0;
  ths.forEach(r=>{
    const diff=(base-r.t)/(1000*60*60*24*7);
    if(diff>=0&&diff<13) sum+=r.a;
  });

  const cur = getGrade(sum);
  let html=`í˜„ì¬ ë“±ê¸‰: <span class="badge" style="background:${cur?.color}">${cur?.name||"ì—†ìŒ"}</span><br>
  ìµœê·¼ 13ì£¼ ì‚¬ìš© ê¸ˆì•¡: ${sum.toLocaleString()}ì›`;

  if(target){
    if(sum>=target.min){
      const end = new Date(base);
      end.setDate(end.getDate()+13*7-1);
      html+=`
      <div class="goal-box">
      ğŸ¯ ëª©í‘œ ë“±ê¸‰: <span class="badge" style="background:${target.color}">${target.name}</span><br>
      âœ… ëª©í‘œ ë‹¬ì„±<br>
      â° ${end.toISOString().slice(0,10)} ê¹Œì§€ ìœ ì§€
      </div>`;
    } else {
      html+=`
      <div class="goal-box">
      ğŸ¯ ëª©í‘œ ë“±ê¸‰: <span class="badge" style="background:${target.color}">${target.name}</span><br>
      âŒ ${(target.min-sum).toLocaleString()}ì› ì¶”ê°€ í•„ìš”
      </div>`;
    }
  }
  summary.innerHTML=html;

  weeks.innerHTML="";
  for(let i=0;i<13;i++){
    const w=new Date(base);
    w.setDate(w.getDate()+i*7);
    let s=0;
    ths.forEach(r=>{
      const diff=(w-r.t)/(1000*60*60*24*7);
      if(diff>=0&&diff<13) s+=r.a;
    });
    const g=getGrade(s);
    weeks.innerHTML+=`
    <tr>
      <td>${w.toISOString().slice(0,10)}</td>
      <td>${s.toLocaleString()}</td>
      <td>${g?.name||"ì—†ìŒ"}</td>
    </tr>`;
  }
}

function toggleTheme(){
  document.body.classList.toggle("dark");
}

const targets=document.getElementById("targets");
MVP_LEVELS.forEach(l=>{
  const b=document.createElement("button");
  b.innerText=l.name;
  b.onclick=()=>{target=l;render();};
  targets.appendChild(b);
});
</script>
</body>
</html>
