<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>ë©”ì´í”ŒìŠ¤í† ë¦¬ MVP ê³„ì‚°ê¸°</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f6f8;
  margin: 0;
}
header {
  background: #0d6efd;
  color: white;
  padding: 10px;
  text-align: center;
}
.container {
  max-width: 1100px;
  margin: 20px auto;
}
.grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 20px;
}
.card {
  background: white;
  border-radius: 10px;
  padding: 20px;
}
button {
  padding: 10px;
  border: none;
  border-radius: 6px;
  cursor: pointer;
}
.btn-blue { background:#0d6efd; color:white; }
.btn-red { background:#dc3545; color:white; }
.grade-btn { margin:5px; width:90px; }
table {
  width:100%;
  border-collapse: collapse;
}
th, td {
  border-bottom: 1px solid #ddd;
  padding: 8px;
  text-align: center;
}
</style>
</head>

<body>

<header>
  ğŸŒ™ ë©”ì´í”ŒìŠ¤í† ë¦¬ MVP ê³„ì‚°ê¸°  
  <div>ì´ë²ˆ ì£¼ í¬í•¨ ìµœê·¼ 13ì£¼ êµ¬ë§¤ ê¸ˆì•¡ ê¸°ì¤€</div>
</header>

<div class="container">

  <div class="grid">
    <!-- ì¢Œì¸¡ -->
    <div class="card">
      <h3>ì¶©ì „ ê¸°ë¡ ì¶”ê°€</h3>
      <input type="date" id="chargeDate"><br><br>
      <input type="number" id="chargeAmount" placeholder="ì¶©ì „ ê¸ˆì•¡"><br><br>
      <button class="btn-blue" onclick="addCharge()">ì¶”ê°€í•˜ê¸°</button>
      <button class="btn-red" onclick="resetAll()">ì „ì²´ ì´ˆê¸°í™”</button>

      <h3 style="margin-top:20px">ëª©í‘œ MVP ë“±ê¸‰</h3>
      <div>
        <button class="btn-blue grade-btn" onclick="setTarget('ë¸Œë¡ ì¦ˆ')">ë¸Œë¡ ì¦ˆ</button>
        <button class="btn-blue grade-btn" onclick="setTarget('ì‹¤ë²„')">ì‹¤ë²„</button>
        <button class="btn-blue grade-btn" onclick="setTarget('ê³¨ë“œ')">ê³¨ë“œ</button>
        <button class="btn-blue grade-btn" onclick="setTarget('ë‹¤ì´ì•„')">ë‹¤ì´ì•„</button>
        <button class="btn-blue grade-btn" onclick="setTarget('ë ˆë“œ')">ë ˆë“œ</button>
        <button class="btn-blue grade-btn" onclick="setTarget('ë¸”ë™')">ë¸”ë™</button>
      </div>
    </div>

    <!-- ìš°ì¸¡ -->
    <div class="card">
      <h3>ğŸ“Œ ìš”ì•½ ì •ë³´</h3>
      <div id="summary"></div>
      <hr>
      <h3>ğŸ“Œ ì¶©ì „ ì¶”ì²œ</h3>
      <div id="recommend"></div>
    </div>
  </div>

  <div class="card" style="margin-top:20px">
    <h3>ğŸ“Š ì£¼ì°¨ë³„ ì˜ˆìƒ ë“±ê¸‰ ì‹œë®¬ë ˆì´ì…˜ (ë‚ ì§œ ê¸°ì¤€)</h3>
    <table>
      <thead>
        <tr>
          <th>ê¸°ì¤€ ë‚ ì§œ</th>
          <th>ì˜ˆìƒ ëˆ„ì </th>
          <th>ì˜ˆìƒ ë“±ê¸‰</th>
        </tr>
      </thead>
      <tbody id="simulation"></tbody>
    </table>
  </div>

  <div class="card" style="margin-top:20px">
    <h3>ğŸ§¾ ì¶©ì „ ê¸°ë¡</h3>
    <table>
      <thead>
        <tr>
          <th>ë‚ ì§œ</th>
          <th>ê¸ˆì•¡</th>
          <th>ì†Œë©¸ ì˜ˆì •ì¼</th>
          <th></th>
        </tr>
      </thead>
      <tbody id="chargeList"></tbody>
    </table>
  </div>

</div>

<script>
const gradeStandard = {
  ë¸Œë¡ ì¦ˆ: 100000,
  ì‹¤ë²„: 300000,
  ê³¨ë“œ: 600000,
  ë‹¤ì´ì•„: 1000000,
  ë ˆë“œ: 2000000,
  ë¸”ë™: 5000000
};

let charges = [];
let targetGrade = null;
const TODAY = new Date();

function addCharge() {
  const date = new Date(document.getElementById("chargeDate").value);
  const amount = Number(document.getElementById("chargeAmount").value);
  if (!date || !amount) return alert("ë‚ ì§œì™€ ê¸ˆì•¡ ì…ë ¥!");

  charges.push({ date, amount });
  updateAll();
}

function resetAll() {
  charges = [];
  targetGrade = null;
  updateAll();
}

function setTarget(grade) {
  targetGrade = grade;
  updateAll();
}

function get13WeekSum(baseDate = TODAY) {
  const limit = new Date(baseDate);
  limit.setDate(limit.getDate() - 91);
  return charges
    .filter(c => c.date >= limit && c.date <= baseDate)
    .reduce((s,c)=>s+c.amount,0);
}

function getGrade(sum) {
  return Object.entries(gradeStandard)
    .reverse()
    .find(([g,v])=>sum>=v)?.[0] || "ì—†ìŒ";
}

function updateAll() {
  renderSummary();
  renderChargeList();
  renderSimulation();
}

function renderSummary() {
  const sum = get13WeekSum();
  const grade = getGrade(sum);

  let html = `
  í˜„ì¬ ë“±ê¸‰: <b>${grade}</b><br>
  ìµœê·¼ 13ì£¼ ëˆ„ì : ${sum.toLocaleString()}ì›<br>
  `;

  if (targetGrade) {
    const need = gradeStandard[targetGrade] - sum;
    html += need <= 0
      ? `<br>ğŸ‰ ëª©í‘œ ${targetGrade} ë‹¬ì„±!`
      : `<br>â— ëª©í‘œ ${targetGrade}ê¹Œì§€ ${need.toLocaleString()}ì› í•„ìš”`;
  }

  document.getElementById("summary").innerHTML = html;
}

function renderChargeList() {
  const tbody = document.getElementById("chargeList");
  tbody.innerHTML = "";
  charges.forEach((c,i)=>{
    const expire = new Date(c.date);
    expire.setDate(expire.getDate()+91);
    tbody.innerHTML += `
      <tr>
        <td>${c.date.toISOString().slice(0,10)}</td>
        <td>${c.amount.toLocaleString()}</td>
        <td>${expire.toISOString().slice(0,10)}</td>
        <td><button onclick="charges.splice(${i},1);updateAll()">ì‚­ì œ</button></td>
      </tr>
    `;
  });
}

function renderSimulation() {
  const tbody = document.getElementById("simulation");
  tbody.innerHTML = "";
  for(let w=0; w<=13; w++){
    const d = new Date(TODAY);
    d.setDate(d.getDate()+w*7);
    const sum = get13WeekSum(d);
    tbody.innerHTML += `
      <tr>
        <td>${d.toISOString().slice(0,10)}</td>
        <td>${sum.toLocaleString()}</td>
        <td>${getGrade(sum)}</td>
      </tr>
    `;
  }
}

updateAll();
</script>

</body>
</html>
