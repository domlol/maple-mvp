<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>ë©”ì´í”ŒìŠ¤í† ë¦¬ MVP ê³„ì‚°ê¸°</title>
<style>
:root {
  --bg: #f4f6f8;
  --card: #ffffff;
  --text: #222;
  --sub: #666;
  --blue: #2563eb;
}
body.dark {
  --bg: #121212;
  --card: #1e1e1e;
  --text: #f1f1f1;
  --sub: #aaa;
}
body {
  margin: 0;
  background: var(--bg);
  color: var(--text);
  font-family: system-ui, -apple-system, sans-serif;
}
header {
  background: var(--blue);
  color: #fff;
  padding: 16px;
  display: flex;
  justify-content: space-between;
}
.container {
  max-width: 1100px;
  margin: 20px auto;
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 20px;
}
.card {
  background: var(--card);
  border-radius: 12px;
  padding: 20px;
}
input {
  width: 100%;
  padding: 12px;
  font-size: 16px;
  box-sizing: border-box;
}
button {
  padding: 10px 14px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
}
button.primary { background: var(--blue); color: #fff; }
button.danger { background: #ef4444; color: #fff; }

.badge {
  padding: 4px 10px;
  border-radius: 999px;
  font-weight: bold;
  font-size: 14px;
}
.bronze { background:#cd7f32;color:#fff }
.silver { background:#9ca3af;color:#fff }
.gold { background:#facc15;color:#000 }
.diamond { background:#38bdf8;color:#000 }
.red { background:#ef4444;color:#fff }
.black { background:#000;color:#fff }

.summary-box {
  margin-top: 14px;
  padding: 14px;
  border-radius: 10px;
  background: rgba(0,0,0,0.04);
}

table {
  width:100%;
  border-collapse: collapse;
}
th,td {
  padding: 10px;
  border-bottom:1px solid #ddd;
  text-align: center;
}
</style>
</head>

<body>
<header>
  <div>ë©”ì´í”ŒìŠ¤í† ë¦¬ MVP ê³„ì‚°ê¸°</div>
  <button onclick="toggleTheme()">ğŸŒ™</button>
</header>

<div class="container">
  <div class="card">
    <h3>ì¶©ì „ ê¸°ë¡ ì¶”ê°€</h3>
    <label>ìºì‹œ ì‚¬ìš© ë‚ ì§œ</label>
    <input type="date" id="dateInput">
    <label>ê¸ˆì•¡</label>
    <input type="number" id="amountInput">
    <br><br>
    <button class="primary" onclick="addCharge()">ì¶”ê°€</button>
    <button class="danger" onclick="resetAll()">ì „ì²´ ì´ˆê¸°í™”</button>

    <h4>ì¶©ì „ ê¸°ë¡</h4>
    <table>
      <thead>
        <tr><th>ë‚ ì§œ</th><th>ê¸ˆì•¡</th><th>ì†Œë©¸</th></tr>
      </thead>
      <tbody id="history"></tbody>
    </table>

    <h4>ëª©í‘œ MVP ë“±ê¸‰</h4>
    <div id="targetBtns"></div>
  </div>

  <div class="card">
    <h3>ğŸ“Œ ìš”ì•½ ì •ë³´</h3>
    <div id="summary"></div>
  </div>
</div>

<div class="container">
  <div class="card" style="grid-column:1/3">
    <h3>ğŸ“Š ì£¼ì°¨ë³„ ì˜ˆìƒ ë“±ê¸‰ ì‹œë®¬ë ˆì´ì…˜</h3>
    <table>
      <thead>
        <tr><th>ê¸°ì¤€ ë‚ ì§œ</th><th>ì˜ˆìƒ ëˆ„ì </th><th>ë“±ê¸‰</th></tr>
      </thead>
      <tbody id="weekly"></tbody>
    </table>
  </div>
</div>

<script>
const MVP = [
  {name:"ë¸Œë¡ ì¦ˆ", value:150000, cls:"bronze"},
  {name:"ì‹¤ë²„", value:300000, cls:"silver"},
  {name:"ê³¨ë“œ", value:600000, cls:"gold"},
  {name:"ë‹¤ì´ì•„", value:900000, cls:"diamond"},
  {name:"ë ˆë“œ", value:1500000, cls:"red"},
  {name:"ë¸”ë™", value:3000000, cls:"black"},
];
let charges = JSON.parse(localStorage.getItem("charges")||"[]");
let target = null;

function toggleTheme(){
  document.body.classList.toggle("dark");
}
function save(){ localStorage.setItem("charges",JSON.stringify(charges)); }

function addCharge(){
  const d = dateInput.value;
  const a = Number(amountInput.value);
  if(!d||!a) return;
  charges.push({date:d,amount:a});
  save(); render();
}

function resetAll(){
  charges=[]; save(); render();
}

function getTotal(base){
  const b=new Date(base);
  return charges.filter(c=>{
    const u=new Date(c.date);
    const e=new Date(u); e.setDate(e.getDate()+91);
    return u<=b && e>b;
  }).reduce((s,c)=>s+c.amount,0);
}
function getGrade(amount){
  return [...MVP].reverse().find(g=>amount>=g.value)||{name:"ì—†ìŒ"};
}

function render(){
  history.innerHTML="";
  charges.sort((a,b)=>new Date(b.date)-new Date(a.date));
  charges.forEach(c=>{
    const e=new Date(c.date); e.setDate(e.getDate()+91);
    history.innerHTML+=`<tr><td>${c.date}</td><td>${c.amount.toLocaleString()}</td><td>${e.toISOString().slice(0,10)}</td></tr>`;
  });

  const today=new Date();
  const total=getTotal(today);
  const grade=getGrade(total);

  let summaryHTML = `
    í˜„ì¬ ë“±ê¸‰: <span class="badge ${grade.cls||""}">${grade.name}</span><br>
    ìµœê·¼ 13ì£¼ ëˆ„ì : ${total.toLocaleString()}ì›
  `;

  if(target){
    if(total>=target.value){
      const expireDates = charges.map(c=>{
        const d=new Date(c.date); d.setDate(d.getDate()+91); return d;
      }).sort((a,b)=>a-b);
      summaryHTML+=`
        <div class="summary-box">
        âœ… ëª©í‘œ ë‹¬ì„± (${target.name})<br>
        ${expireDates[0].toISOString().slice(0,10)} ê¹Œì§€ ìœ ì§€ ê°€ëŠ¥
        </div>`;
    }else{
      summaryHTML+=`
        <div class="summary-box">
        âŒ ëª©í‘œ ë¯¸ë‹¬ (${target.name})<br>
        ${(target.value-total).toLocaleString()}ì› ì¶”ê°€ í•„ìš”
        </div>`;
    }
  }
  summary.innerHTML=summaryHTML;

  weekly.innerHTML="";
  for(let i=0;i<9;i++){
    const d=new Date(); d.setDate(d.getDate()+i*7);
    const t=getTotal(d);
    const g=getGrade(t);
    weekly.innerHTML+=`
      <tr><td>${d.toISOString().slice(0,10)}</td>
      <td>${t.toLocaleString()}</td><td>${g.name}</td></tr>`;
  }
}

const btns=document.getElementById("targetBtns");
MVP.forEach(g=>{
  const b=document.createElement("button");
  b.textContent=g.name;
  b.onclick=()=>{target=g;render();}
  btns.appendChild(b);
});

render();
</script>
</body>
</html>
