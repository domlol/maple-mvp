<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>MVP ê³„ì‚°ê¸°</title>
<style>
/* (ìŠ¤íƒ€ì¼ì€ ì´ì „ê³¼ ë™ì¼ â€” ë³€ê²½ ì—†ìŒ) */
:root {
  --bg:#f5f6f7; --card:#fff; --text:#222;
  --accent:#2563eb; --notice-bg:#fde68a; --notice-text:#000;
}
body.dark {
  --bg:#121212; --card:#1e1e1e; --text:#f1f1f1;
  --notice-bg:#3f3f46; --notice-text:#facc15;
}
body {margin:0;font-family:system-ui;background:var(--bg);color:var(--text);}
header{background:#2563eb;color:#fff;padding:14px 20px;display:flex;justify-content:space-between}
.container{max-width:1100px;margin:20px auto;padding:0 12px}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:20px}
.card{background:var(--card);border-radius:12px;padding:18px}
.notice{margin:12px 0;padding:12px;border-radius:10px;background:var(--notice-bg);color:var(--notice-text);font-weight:700}
.badge{padding:8px 18px;border-radius:999px;font-weight:700;color:#fff}
.badge-ë¸Œë¡ ì¦ˆ{background:#cd7f32}
.badge-ì‹¤ë²„{background:#9ca3af}
.badge-ê³¨ë“œ{background:#facc15;color:#000}
.badge-ë‹¤ì´ì•„{background:#38bdf8}
.badge-ë ˆë“œ{background:#ef4444}
.badge-ë¸”ë™{background:#000}
.highlight-amount{font-size:20px;font-weight:800;color:var(--accent)}
.time-highlight{font-weight:800;color:#ef4444}
table{width:100%;border-collapse:collapse}
th,td{padding:10px;border-bottom:1px solid #ccc;text-align:center}
</style>
</head>

<body>
<header>
  MVP ê³„ì‚°ê¸°
  <button onclick="document.body.classList.toggle('dark')">ğŸŒ™/â˜€ï¸</button>
</header>

<div class="container">

<div class="grid">
<div class="card">
<h3>ì¶©ì „ ê¸°ë¡ ì¶”ê°€</h3>
<input type="date" id="dateInput">
<input type="number" id="amountInput">
<button onclick="addRecord()">ì¶”ê°€</button>
<button onclick="records=[];update()">ì „ì²´ ì´ˆê¸°í™”</button>

<div class="notice">âš ï¸ ìºì‹œ ì‚¬ìš© ë‚ ì§œë¥¼ ì…ë ¥í•˜ì„¸ìš”</div>

<table>
<thead><tr><th>ë‚ ì§œ</th><th>ê¸ˆì•¡</th><th>ì‚­ì œ</th></tr></thead>
<tbody id="recordTable"></tbody>
</table>
</div>

<div class="card">
<h3>ğŸ“Œ ìš”ì•½ ì •ë³´</h3>
<p>í˜„ì¬ ë“±ê¸‰: <span id="currentBadge"></span></p>
<p>ëª©í‘œ ë“±ê¸‰: <span id="targetBadge"></span></p>
<p>ìµœê·¼ 13ì£¼ ëˆ„ì : <span id="totalText" class="highlight-amount"></span></p>
<p id="goalText"></p>
</div>
</div>

<div class="card">
<h3>ğŸ“Š ì£¼ì°¨ë³„ ì˜ˆìƒ ë“±ê¸‰ ì‹œë®¬ë ˆì´ì…˜ (14ì£¼)</h3>
<table>
<thead><tr><th>ê¸°ì¤€ ë‚ ì§œ(ëª©)</th><th>ëˆ„ì </th><th>ë“±ê¸‰</th></tr></thead>
<tbody id="weekTable"></tbody>
</table>
</div>

</div>

<script>
const MVP=[
{name:"ë¸Œë¡ ì¦ˆ",min:150000},
{name:"ì‹¤ë²„",min:300000},
{name:"ê³¨ë“œ",min:600000},
{name:"ë‹¤ì´ì•„",min:900000},
{name:"ë ˆë“œ",min:1500000},
{name:"ë¸”ë™",min:3000000}
];

let records=[], target="ë ˆë“œ";

function formatDateKST(d){
  const y=d.getFullYear();
  const m=String(d.getMonth()+1).padStart(2,"0");
  const day=String(d.getDate()).padStart(2,"0");
  return `${y}-${m}-${day}`;
}

function getLastThursday(base=new Date()){
  const d=new Date(base);
  d.setHours(12,0,0,0);
  const diff=d.getDay()>=4?d.getDay()-4:d.getDay()+3;
  d.setDate(d.getDate()-diff);
  d.setHours(0,0,0,0);
  return d;
}

function grade(a){return MVP.filter(m=>a>=m.min).pop()}

function calc13WeeksTotal(th){
  const end=new Date(th);
  end.setDate(end.getDate()+6);
  end.setHours(23,59,59,999);
  const start=new Date(end);
  start.setDate(start.getDate()-90);
  return records.filter(r=>{
    const d=new Date(r.date);
    return d>=start&&d<=end;
  }).reduce((t,r)=>t+r.amount,0);
}

function addRecord(){
  records.push({date:dateInput.value,amount:+amountInput.value});
  update();
}

function update(){
  recordTable.innerHTML="";
  records.forEach((r,i)=>{
    recordTable.innerHTML+=`<tr>
    <td>${r.date}</td><td>${r.amount.toLocaleString()}</td>
    <td><button onclick="records.splice(${i},1);update()">X</button></td></tr>`;
  });

  const base=getLastThursday();
  const total=calc13WeeksTotal(base);
  const cur=grade(total), tar=MVP.find(m=>m.name===target);

  currentBadge.innerHTML=cur?`<span class="badge badge-${cur.name}">${cur.name}</span>`:"ì—†ìŒ";
  targetBadge.innerHTML=`<span class="badge badge-${tar.name}">${tar.name}</span>`;
  totalText.innerText=total.toLocaleString()+"ì›";

  weekTable.innerHTML="";
  for(let i=0;i<14;i++){
    const d=new Date(base);
    d.setDate(d.getDate()+7*i);
    const sum=calc13WeeksTotal(d);
    const g=grade(sum);
    weekTable.innerHTML+=`
    <tr><td>${formatDateKST(d)}</td>
    <td>${sum.toLocaleString()}</td>
    <td>${g?g.name:"ì—†ìŒ"}</td></tr>`;
  }
}

update();
</script>
</body>
</html>
